#!/bin/sh
# Standardized pre-commit hook for ProFile repositories
# Source: octopus-workflows/scripts/husky/pre-commit
#
# Run: unit tests, smoke tests, oxlint, typecheck
# These are the minimum checks for fast feedback before committing.
#
# CI will run additional checks:
# - Full ESLint with type-aware rules
# - Integration tests
# - Docker build

echo "Pre-commit checks (fast feedback loop)..."
echo ""

# 1. Type check
echo "  -> Type checking..."
bun run typecheck || exit 1

# 2. Fast lint with oxlint
echo "  -> Fast lint (oxlint)..."
bun run lint:fast || exit 1

# 3. Unit tests
echo "  -> Running unit tests..."
bun test || exit 1

# 4. Smoke tests (critical path)
echo "  -> Running smoke tests..."
bun test --config=bunfig.smoke.toml || exit 1

echo ""
echo "âœ… Pre-commit passed!"
